# Kairos V2 Backend - Project Context

## 项目概述

Kairos 是一个投资分析系统，专注于从上到下的资产投资价值分析。系统通过多维度分析，识别具有投资潜力的资产类别和具体标的。

## 业务场景

### 投资分析流程

1. **宏观分析**: 识别具有投资机会的资产类别

   - 股票市场（如中国白酒板块）
   - 加密货币（如比特币）
   - 大宗商品（如原油）
   - 其他资产类别

2. **微观分析**: 在选定类别中确定具体投资标的

   - 例如：白酒板块中贵州茅台机会最大
   - 基于多维度数据分析和 AI 模型预测

3. **实时监控**: 持续跟踪和分析市场变化

## 技术架构

### 核心技术栈

- **框架**: SST (Serverless Stack) - 纯 Serverless 架构
- **多语言支持**: Node.js, Golang, Python
- **API 设计**: REST + GraphQL
- **AI 集成**: Vercel AI SDK (Agent 后端)
- **数据源**: Python akshare (金融数据爬取)
- **性能优化**: Golang (高性能 API)
- **实时通信**: Stream (Agent 实时反馈)
- **监控**: Langfuse (Prompt 管理)

### 架构组件

#### 1. API 层

- **REST API**: 传统 CRUD 操作
- **GraphQL**: 复杂查询和实时数据
- **GraphQL Federation**: 多模块联邦查询
- **认证授权**: 用户登录验证机制

#### 2. 数据处理层

- **数据爬取**: Python akshare (定时任务)
- **数据存储**: AWS DynamoDB
- **数据同步**: 定时任务调度
- **实时流处理**: Stream 数据流

#### 3. AI/Agent 层

- **Vercel AI SDK**: Agent 后端服务
- **Langfuse**: Prompt 管理和监控
- **实时反馈**: Stream 通信
- **智能分析**: 投资建议生成

#### 4. 任务调度

- **定时任务**: 每日数据爬取
- **事件驱动**: 响应式数据处理
- **任务队列**: 异步任务处理

### 多语言分工

#### Python

- 数据爬取 (akshare)
- 数据分析处理
- 机器学习模型
- 定时任务

#### Golang

- 高性能 API
- 实时数据处理
- 系统监控
- 微服务通信

#### Node.js

- GraphQL 服务
- API 网关
- 前端集成
- 工具链管理

## 开发指南

### 项目结构

```
Kairos-BE/
├── functions/          # Lambda函数 (Python/Golang/Node.js)
├── core/              # 共享业务逻辑
├── stacks/            # SST基础设施定义
├── docs/              # 项目文档
├── tests/             # 测试文件
└── tools/             # 开发工具
```

### 开发原则

1. **Serverless 优先**: 充分利用 AWS Lambda 和 SST
2. **多语言协作**: 根据场景选择最适合的语言
3. **模块化设计**: 清晰的模块边界和接口
4. **实时性**: 支持实时数据流和反馈
5. **可扩展性**: 支持业务快速扩展

### 关键技术挑战

1. **多语言协调**: 不同语言服务间的通信和数据共享
2. **实时流处理**: Agent 实时反馈和数据处理
3. **数据同步**: 定时任务和实时数据的一致性
4. **认证授权**: 跨语言服务的统一认证机制
5. **性能优化**: 高并发场景下的性能保证

## 部署和运维

### 环境配置

- **开发环境**: 本地 SST 开发
- **测试环境**: AWS 测试环境
- **生产环境**: AWS 生产环境

### 监控和日志

- **应用监控**: AWS CloudWatch
- **性能监控**: AWS X-Ray
- **日志管理**: 结构化日志记录
- **错误追踪**: 异常监控和告警

## 下一步计划

1. **基础设施搭建**: 完善 SST 配置和 AWS 资源
2. **核心模块开发**: 实现基础的数据处理和分析功能
3. **API 设计**: 设计 REST 和 GraphQL 接口
4. **认证系统**: 实现用户认证和授权
5. **AI 集成**: 集成 Vercel AI SDK 和 Langfuse
6. **测试和部署**: 完善测试覆盖和部署流程

---

**注意**: 此文档应定期更新，确保与项目发展保持同步。开发过程中遇到的技术决策和架构变更应及时记录在此文档中。
